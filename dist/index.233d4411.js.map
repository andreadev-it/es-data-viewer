{"mappings":"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","sources":["src/es-data/ParsedData.ts","../canvas-lib/dist/utils.js","../canvas-lib/dist/modules/pan-zoom-plugin.js","src/es-data/Color.ts","src/es-data/Object.ts","src/es-data/StarSystem.ts","src/es-data/Galaxies.ts","../data-parser/dist/structures.js","../data-parser/dist/parser.js","../data-parser/dist/main.js","src/es-data/Government.ts","src/es-data/Planet.ts","src/es-data/Wormhole.ts","src/src/parse.ts","../canvas-lib/dist/main.js","src/src/views/galaxy.ts","src/src/setupCanvasLib.ts","src/utils.ts","src/main.ts","src/src/ui.ts"],"sourcesContent":["import { Color } from \"./Color\";\nimport { Galaxy } from \"./Galaxies\";\nimport { Government } from \"./Government\";\nimport { PlanetDetails } from \"./Planet\";\nimport { StarSystem, SystemLink } from \"./StarSystem\";\nimport { WormholeDetails } from \"./Wormhole\";\n\nexport class ParsedData {\n    galaxies: Map<string, Galaxy> = new Map();\n    starSystems: Map<string, StarSystem> = new Map();\n    colors: Map<string, Color> = new Map();\n    sprites: Map<string, File> = new Map();\n    governments: Map<string, Government> = new Map();\n    planets: Map<string, PlanetDetails> = new Map();\n    wormholes: Map<string, WormholeDetails> = new Map();\n    starSystemsLinks: Set<string> = new Set();\n\n    constructor() {}\n\n    addGalaxy(galaxy: Galaxy) {\n        this.galaxies.set(galaxy.name, galaxy);\n    }\n\n    addStarSystem(starSystem: StarSystem) {\n        this.starSystems.set(starSystem.name, starSystem);\n        for (let link of starSystem.links) {\n            let linkedSystem = this.starSystems.get(link);\n            if (linkedSystem) {\n                let linkString = `${starSystem.name}___${linkedSystem.name}`;\n                let reverseLinkString = `${linkedSystem.name}___${starSystem.name}`;\n                if (!this.starSystems.has(reverseLinkString))\n                    this.starSystemsLinks.add(linkString);\n            }\n        }\n    }\n\n    addSprite(path: string, sprite: File) {\n        this.sprites.set(path, sprite);\n    }\n\n    addColor(color: Color) {\n        this.colors.set(color.name, color);\n    }\n\n    addGovernment(gov: Government) {\n        this.governments.set(gov.name, gov);\n    }\n\n    addPlanet(planet: PlanetDetails) {\n        this.planets.set(planet.name, planet);\n    }\n\n    addWormhole(wormhole: WormholeDetails) {\n        this.wormholes.set(wormhole.name, wormhole);\n    }\n}\n","export function throttle(func, wait) {\n    let timeout;\n    let isThrottled = false;\n    return function () {\n        if (isThrottled) {\n            return;\n        }\n        const context = this;\n        const args = arguments;\n        func.apply(context, args);\n        clearTimeout(timeout);\n        timeout = setTimeout(() => (isThrottled = false), wait);\n        isThrottled = true;\n    };\n}\n","import { throttle } from \"../utils\";\nexport class PanZoomPlugin {\n    constructor(app, settings) {\n        var _a, _b, _c;\n        this.app = app;\n        this.settings = settings;\n        this.name = \"PanZoom\";\n        this.currentZoom = 1;\n        this.minZoom = 0.1;\n        this.maxZoom = 10;\n        this.cameraOffset = { x: 0, y: 0 };\n        this.isPanning = false;\n        this.startedPanningOffset = { x: 0, y: 0 };\n        this.startedPanningPosition = { x: 0, y: 0 };\n        this.throttle = -1;\n        this.bindEvents();\n        this.minZoom = (_a = settings.minZoom) !== null && _a !== void 0 ? _a : this.minZoom;\n        this.maxZoom = (_b = settings.maxZoom) !== null && _b !== void 0 ? _b : this.maxZoom;\n        this.throttle = (_c = settings.throttle) !== null && _c !== void 0 ? _c : this.throttle;\n        this.throttledPaint = throttle(this.app.paint.bind(this.app), this.throttle);\n    }\n    bindEvents() {\n        this.app.on('prerender', this.transformCanvas.bind(this));\n        this.app.canvas.addEventListener('pointerdown', this.onPointerDown.bind(this));\n        this.app.canvas.addEventListener('pointerup', this.onPointerUp.bind(this));\n        this.app.canvas.addEventListener('pointermove', this.onPointerMove.bind(this));\n        this.app.canvas.addEventListener('pointerleave', this.onPointerUp.bind(this));\n        this.app.canvas.addEventListener('wheel', this.onScroll.bind(this));\n    }\n    screenToLocalPoint(x, y) {\n        let hw = this.app.canvas.width / 2;\n        let hh = this.app.canvas.height / 2;\n        let tx = this.cameraOffset.x;\n        let ty = this.cameraOffset.y;\n        let z = this.currentZoom;\n        // center\n        x = x - hw;\n        y = y - hh;\n        // scale\n        x = x / z;\n        y = y / z;\n        // trnaslate\n        x = x - tx;\n        y = y - ty;\n        return { x, y };\n    }\n    zoom(amount) {\n        this.currentZoom += amount;\n        this.currentZoom = Math.min(Math.max(this.minZoom, this.currentZoom), this.maxZoom);\n        this.currentZoom = Math.floor(this.currentZoom * 1000) / 1000;\n        this.updateRender();\n    }\n    transformCanvas(e) {\n        e.detail.context.scale(this.currentZoom, this.currentZoom);\n        e.detail.context.translate(this.cameraOffset.x, this.cameraOffset.y);\n    }\n    onPointerDown(e) {\n        this.isPanning = true;\n        this.startedPanningOffset = this.cameraOffset;\n        this.startedPanningPosition = { x: e.clientX, y: e.clientY };\n    }\n    onPointerUp(_) {\n        this.isPanning = false;\n    }\n    onPointerMove(e) {\n        if (this.isPanning) {\n            this.cameraOffset = {\n                x: this.startedPanningOffset.x + ((e.clientX - this.startedPanningPosition.x) / this.currentZoom),\n                y: this.startedPanningOffset.y + ((e.clientY - this.startedPanningPosition.y) / this.currentZoom),\n            };\n            this.updateRender();\n        }\n    }\n    onScroll(e) {\n        this.zoom(e.deltaY / 1000);\n    }\n    updateRender() {\n        if (this.throttle > 0) {\n            this.throttledPaint();\n        }\n        else {\n            this.app.paint();\n        }\n    }\n    static getDataFromMatrix(matrix) {\n        return {\n            scaleX: matrix.a,\n            scaleY: matrix.d,\n            translateX: matrix.e,\n            translateY: matrix.f,\n            skewX: matrix.b,\n            skewY: matrix.c\n        };\n    }\n    static fixedNumber(number, context, direction = 'x') {\n        let { scaleX, scaleY } = this.getDataFromMatrix(context.getTransform());\n        return direction == 'x' ? number * (1 / scaleX) : number * (1 / scaleY);\n    }\n    static fixedSize(width, height, context) {\n        let { scaleX, scaleY } = this.getDataFromMatrix(context.getTransform());\n        return {\n            width: width * (1 / scaleX),\n            height: height * (1 / scaleY)\n        };\n    }\n}\n","import { Line } from \"es-data-parser/dist/structures\";\nimport { ParsedData } from \"./ParsedData\";\n\nexport class Color {\n    constructor(public name: string, public r: number, public g: number, public b: number, public a: number = 255) {}\n\n    toString() {\n        if (this.a == 255) {\n            return `rgb(${this.r}, ${this.g}, ${this.b})`;\n        }\n        return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;\n    }\n\n    static fromLine(dataLine: Line) {\n        let label = dataLine.tokens[1];\n        let r = parseFloat(dataLine.tokens[2]);\n        let g = parseFloat(dataLine.tokens[3]);\n        let b = parseFloat(dataLine.tokens[4]);\n        let a = 255\n        if (dataLine.tokens.length == 6) {\n            a = parseFloat(dataLine.tokens[5]);\n        }\n\n        return Color.fromPercentages(label, r, g, b, a);\n    }\n\n    static fromPercentages(label: string, r: number, g: number, b: number, a: number) {\n        return new Color(label, r * 255, g * 255, b * 255, a * 255);\n    }\n\n    static fromGovernment(data: ParsedData, govName: string) {\n        let government = data.governments.get(govName);\n        if (!government) {\n            return null;\n        }\n\n        if (government.color instanceof Color) {\n            return government.color;\n        }\n\n        let color = data.colors.get(government.color);\n        if (!color) {\n            return null;\n        }\n\n        return color;\n    }\n}\n","// This class represents different kind of objects\n// that you can find in a star system. \nimport { ParsedData } from \"./ParsedData\";\nimport { Line } from \"es-data-parser/dist/structures\";\n\nexport class SystemObject {\n    name = \"\";\n    sprite = \"\";\n    spriteImage: HTMLImageElement | null = null;\n    distance: number;\n    period: number;\n    offset: number = 0;\n    objects: SystemObject[] = [];\n\n    constructor(private esData: ParsedData, distance: number, period: number, offset = 0) {\n        this.distance = distance;\n        this.period = period;\n    }\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'object') {\n            throw new Error(\"Not an object\");\n        }\n\n        const name = (dataLine.tokens.length == 2) ? dataLine.tokens[1] : \"\";\n        let sprite = \"\";\n        let distance = 0;\n        let period = 0;\n        let offset = 0;\n        const objects = [];\n        for (let child of dataLine.children) {\n            switch (child.tokens[0]) {\n                case 'sprite':\n                    sprite = child.tokens[1];\n                    break;\n                case 'distance':\n                    distance = parseFloat(child.tokens[1]);\n                    break;\n                case 'period':\n                    period = parseFloat(child.tokens[1]);\n                    break;\n                case 'offset':\n                    offset = parseFloat(child.tokens[1]);\n                    break;\n                case 'object':\n                    objects.push(SystemObject.fromLine(data, child));\n            }\n        }\n\n        const systemObject = new SystemObject(data, distance, period, offset);\n        systemObject.name = name;\n        systemObject.objects = objects;\n        systemObject.sprite = sprite;\n\n        return systemObject;\n    }\n\n    loadImage(): Promise<void> {\n        if (this.spriteImage) return Promise.resolve();\n        if (this.sprite == '') return Promise.resolve();\n\n        return new Promise((resolve, reject) => {\n            let sprite = this.esData.sprites.get(this.sprite)\n\n            // In case the image file isn't available\n            if (!sprite) {\n                resolve();\n                return;\n            }\n\n            let url = URL.createObjectURL(sprite);\n            let img = new Image();\n\n            img.onload = () => {\n                this.spriteImage = img;\n                resolve();\n            }\n            \n            img.onerror = () => {\n                reject()\n            }\n\n            img.src = url;\n        })\n    }\n}\n","import { Line } from \"es-data-parser/dist/structures\";\nimport { PanZoomPlugin } from \"@andreadev/canvas-lib/dist/modules/pan-zoom-plugin\";\nimport { Drawable, Point, BoundingClientRect } from \"@andreadev/canvas-lib/dist/modules/drawables\";\nimport { ParsedData } from \"./ParsedData\";\nimport { Color } from \"./Color\";\nimport { SystemObject } from \"./Object\";\n\nexport type SystemLink = [Point, Point];\n\nexport const starSystemsMap = new Map<string, StarSystem>();\n\nexport class StarSystem implements Drawable {\n    name: string;\n    position: Point;\n    links: string[] = [];\n    government: string = \"\";\n    esData: ParsedData;\n    attributes: string[] = [];\n    objects: SystemObject[] = [];\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'system') {\n            throw new Error(\"Not a system\");\n        }\n\n        const name = dataLine.tokens[1];\n        let pos: Point = {x:0, y:0};\n        let foundPos = false;\n        let links: string[] = [];\n        let government = \"\";\n        let attributes: string[] = [];\n        const objects: SystemObject[] = [];\n        for (let child of dataLine.children) {\n            switch (child.tokens[0]) {\n                // Extract the position\n                case 'pos':\n                    pos = {\n                        x: parseInt(child.tokens[1]),\n                        y: parseInt(child.tokens[2])\n                    };\n                    foundPos = true;\n                    break;\n                // Extract the links\n                case 'link':\n                    links.push(child.tokens[1]);\n                    break;\n                // Set the system government\n                case 'government':\n                    government = child.tokens[1];\n                    break;\n                // Save a list of attributes\n                case 'attributes':\n                    attributes = child.tokens.slice(1);\n                    break;\n                // Parse the objects in the system\n                case 'object':\n                    objects.push(SystemObject.fromLine(data, child));\n            }\n        }\n\n        if (!foundPos) {\n            throw new Error(\"No position found for this system\");\n        }\n\n        const system = new StarSystem(data, name, pos);\n        system.links = links;\n        system.government = government;\n        system.attributes = attributes;\n        system.objects = objects;\n        \n        starSystemsMap.set(name, system);\n\n        return system;\n    }\n\n    constructor(data: ParsedData, name: string, pos: Point) {\n        this.name = name;\n        this.position = pos;\n        this.esData = data;\n\n        starSystemsMap.set(name, this);\n    }\n\n    getBCR(): BoundingClientRect {\n        return {\n            top: this.position.y - 3,\n            bottom: this.position.y + 3,\n            left: this.position.x - 3,\n            right: this.position.x + 3,\n            width: 6,\n            height: 6\n        };\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        this.renderLinks(ctx);\n        this.renderDot(ctx);\n        this.renderName(ctx);\n    }\n\n    renderLinks(ctx: CanvasRenderingContext2D) {\n        // Render the links\n        ctx.lineWidth = PanZoomPlugin.fixedNumber(1, ctx);\n        ctx.strokeStyle = 'rgba(255,255,255,0.2)';\n        for (let link of this.links) {\n            ctx.beginPath();\n            ctx.moveTo(this.position.x, this.position.y);\n\n            const targetSystem = starSystemsMap.get(link);\n            if (!targetSystem)\n                continue;\n\n            ctx.lineTo(targetSystem.position.x, targetSystem.position.y);\n            ctx.stroke();\n        }\n    }\n\n    renderDot(ctx: CanvasRenderingContext2D) {\n        // Render the circle\n        // Get the government color\n        let color = Color.fromGovernment(this.esData, this.government)?.toString();\n        if (!color) {\n            color = '#aaa';\n        }\n\n        ctx.beginPath();\n        ctx.fillStyle = 'black';\n        ctx.strokeStyle = color;\n        ctx.lineWidth = PanZoomPlugin.fixedNumber(2, ctx);\n        let {width, height} = PanZoomPlugin.fixedSize(3, 3, ctx);\n        ctx.ellipse(this.position.x, this.position.y, width, height, 0, 0, 2 * Math.PI);\n        ctx.fill();\n        ctx.stroke();\n    }\n\n    renderName(ctx: CanvasRenderingContext2D) {\n        // Render the name\n        let { scaleX: scale } = PanZoomPlugin.getDataFromMatrix(ctx.getTransform());\n        // If it's too small to render the name, interrupt the function\n        if (scale < 0.5) {\n            return;\n        }\n\n        let fontSize = PanZoomPlugin.fixedNumber(12, ctx)\n        ctx.font = `${fontSize}px Arial`;\n        ctx.fillStyle = 'rgba(255,255,255,0.3)';\n        let offset = PanZoomPlugin.fixedNumber(4, ctx);\n        let {width, height} = PanZoomPlugin.fixedSize(3, 3, ctx);\n        ctx.fillText(this.name, this.position.x + width + offset, this.position.y + height);\n    }\n}\n","import { Line } from \"es-data-parser/dist/structures\";\nimport { ParsedData } from \"./ParsedData\";\nimport { Point } from \"@andreadev/canvas-lib/dist/modules/drawables\";\n\nexport class Galaxy {\n    esData: ParsedData;\n\n    name: string;\n    position: Point = {x:0, y:0};\n    sprite = \"\";\n    spriteImage: HTMLImageElement | null = null;\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'galaxy') {\n            throw new Error(\"Not a galaxy\");\n        }\n\n        const name = dataLine.tokens[1];\n        let pos: Point = {x:0, y:0};\n        let foundPos = false;\n        let sprite: string = \"\";\n        for (let child of dataLine.children) {\n            if (child.tokens[0] == 'pos') {\n                pos = {\n                    x: parseInt(child.tokens[1]),\n                    y: parseInt(child.tokens[2])\n                };\n                foundPos = true;\n                continue;\n            }\n            \n            if (child.tokens[0] == 'sprite') {\n                sprite = child.tokens[1];\n            }\n        }\n\n        if (!foundPos) {\n            throw new Error(\"No position found for this system\");\n        }\n\n        const galaxy = new Galaxy(data, name, pos);\n        galaxy.sprite = sprite;\n\n        return galaxy;\n    }\n\n    constructor(data: ParsedData, name: string, pos: Point) {\n        this.name = name;\n        this.position = pos;\n        this.esData = data;\n    }\n\n    loadImage(): Promise<void> {\n        if (this.spriteImage) return Promise.resolve();\n        if (this.sprite == '') return Promise.resolve();\n\n        return new Promise((resolve, reject) => {\n            let sprite = this.esData.sprites.get(this.sprite)\n\n            // In case the image file isn't available\n            if (!sprite) {\n                resolve();\n                return;\n            }\n\n            let url = URL.createObjectURL(sprite);\n            let img = new Image();\n\n            img.onload = () => {\n                this.spriteImage = img;\n                resolve();\n            }\n            \n            img.onerror = () => {\n                reject()\n            }\n\n            img.src = url;\n            \n        })\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        // Render the sprite\n        if (this.sprite == '') {\n            return;\n        }\n\n        if (this.spriteImage == null) {\n            console.error(\"Sprite image used before loading!\");\n        }\n        else {\n            ctx.drawImage(\n                this.spriteImage,\n                this.position.x - (this.spriteImage.width / 2),\n                this.position.y - (this.spriteImage.height / 2)\n            );\n        }\n    }\n}\n","export class Line {\n    constructor(tokens, indentation) {\n        this.tokens = tokens;\n        this.indentation = indentation;\n        this.children = [];\n    }\n    toString() {\n        const tokensText = [...this.tokens];\n        let text = \"\";\n        for (const token of tokensText) {\n            if (token.includes(' ')) {\n                if (token.includes('\"')) {\n                    text += \"`\" + token + \"`\";\n                }\n                else {\n                    text += `\"${token}\"`;\n                }\n            }\n            else {\n                text += token + \" \";\n            }\n        }\n        return text;\n    }\n}\nexport class FileRoot extends Line {\n    constructor(tokens, indentation, filename) {\n        super(tokens, indentation);\n        this.tokens = tokens;\n        this.indentation = indentation;\n        this.isRoot = true;\n        this.filename = filename;\n    }\n}\n","import { Line, FileRoot } from \"./structures\";\nexport function parse(data, filename = \"\") {\n    const root = new FileRoot([], 0, filename);\n    let isQuoteOpen = false;\n    let isComment = false;\n    let currentQuote = \"\";\n    let currentLine = new Line([], 0);\n    let currentToken = \"\";\n    let parentLevels = [root];\n    for (let i = 0; i < data.length; i++) {\n        const c = data[i];\n        let nextLine = null;\n        if (isComment && c != '\\n')\n            continue;\n        switch (c) {\n            // handle comments\n            case '#':\n                if (currentToken.length == 0 && !isQuoteOpen) {\n                    isComment = true;\n                }\n                break;\n            // handle quotes\n            case '\"':\n            case '`':\n                if (isQuoteOpen && c == currentQuote) {\n                    isQuoteOpen = false;\n                    if (currentToken.length == 0) {\n                        currentLine.tokens.push('');\n                    }\n                    break;\n                }\n                if (!isQuoteOpen && currentToken.length == 0) {\n                    isQuoteOpen = true;\n                    currentQuote = c;\n                    break;\n                }\n                if (!isQuoteOpen) {\n                    throw new Error(`Unescaped quote in string after ${currentToken}`);\n                }\n                break;\n            // handle newlines\n            case '\\n':\n                if (currentToken != '' && !isComment) {\n                    currentLine.tokens.push(currentToken);\n                }\n                currentToken = '';\n                isComment = false;\n                nextLine = new Line([], 0);\n                // ignore blank lines\n                if (currentLine.tokens.length == 0) {\n                    currentLine = nextLine;\n                    continue;\n                }\n                // handle too much indentation\n                if (currentLine.indentation > parentLevels.length - 1) {\n                    throw new Error(`Unexpected indentation for line ${currentLine.tokens.join(' ')}`);\n                }\n                // adding the line as children to its parent based on indentation\n                if (currentLine.indentation >= 0) {\n                    parentLevels[currentLine.indentation].children.push(currentLine);\n                }\n                // adding new line as parent level for following data\n                if (currentLine.indentation == parentLevels.length - 1) {\n                    parentLevels.push(currentLine);\n                }\n                else {\n                    // if indentation is smaller then the number of parents, it means that\n                    // previous deeper nested parents has ended their block, so we delete them\n                    parentLevels = parentLevels.slice(0, currentLine.indentation + 1);\n                    parentLevels.push(currentLine);\n                }\n                if (isQuoteOpen) {\n                    throw new Error(`A quote was left open near: '${currentToken}'`);\n                }\n                currentLine = nextLine;\n                break;\n            // handle spaces\n            case ' ':\n                if (!isQuoteOpen) {\n                    if (currentToken.length > 0) {\n                        currentLine.tokens.push(currentToken);\n                        currentToken = \"\";\n                    }\n                }\n                else {\n                    currentToken += \" \";\n                }\n                break;\n            // handle tabs\n            case '\\t':\n                if (!isQuoteOpen &&\n                    currentLine.tokens.length == 0 &&\n                    currentToken.length == 0) {\n                    currentLine.indentation++;\n                }\n                else if (!isQuoteOpen && currentToken.length > 0) {\n                    // Add tabs as token separators too to avoid the error in some official files\n                    currentLine.tokens.push(currentToken);\n                    currentToken = \"\";\n                }\n                else {\n                    currentToken += \"\\t\";\n                }\n                break;\n            // handle other characters\n            default:\n                currentToken += c;\n        }\n    }\n    return root;\n}\n","import { parse } from \"./parser\";\nexport function parseFile(file, filename) {\n    return new Promise((resolve, _) => {\n        const reader = new FileReader();\n        reader.onload = () => {\n            const data = reader.result;\n            resolve(parse(data, filename));\n        };\n        reader.readAsText(file);\n    });\n}\nexport function parseText(data, filename) {\n    return parse(data, filename);\n}\n","import { Line } from \"es-data-parser/dist/structures\";\nimport { Color } from \"./Color\";\nimport { ParsedData } from \"./ParsedData\";\n\nexport class Government {\n    esData: ParsedData;\n\n    name: string;\n    color: string | Color = \"\";\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'government') {\n            throw new Error(\"Not a government\");\n        }\n\n        const name = dataLine.tokens[1];\n\n        let color: string | Color = \"\";\n\n        for (let child of dataLine.children) {\n            if (child.tokens[0] == 'color') {\n                if (child.tokens.length == 2) {\n                    color = child.tokens[1];\n                }\n                else {\n                    let r = parseFloat(dataLine.tokens[1]);\n                    let g = parseFloat(dataLine.tokens[2]);\n                    let b = parseFloat(dataLine.tokens[3]);\n                    let a = 255\n                    if (dataLine.tokens.length == 5) {\n                        a = parseFloat(dataLine.tokens[4]);\n                    }\n                    color = Color.fromPercentages('', r, g, b, a);\n                }\n            }\n        }\n\n        const government = new Government(data, name);\n        government.color = color;\n\n        return government;\n    }\n\n    constructor(data: ParsedData, name: string) {\n        this.esData = data;\n        this.name = name;\n    }\n}\n","import { ParsedData } from \"./ParsedData\";\nimport { Line } from \"es-data-parser/dist/structures\";\nimport { WormholeDetails } from \"./Wormhole\";\n\nexport class PlanetDetails {\n    wormhole: string = \"\";\n\n    constructor(private esData: ParsedData, public name: string) {}\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'planet') {\n            throw new Error(\"Not a planet\");\n        }\n\n        const name = dataLine.tokens[1];\n\n        let wormhole: string = \"\";\n        for (let child of dataLine.children) {\n            if (child.tokens[0] == 'wormhole') {\n                wormhole = child.tokens[1];\n            }\n        }\n\n        let planet = new PlanetDetails(data, name);\n        planet.wormhole = wormhole;\n\n        return planet;\n    }\n}\n","import { Color } from \"./Color\";\nimport { ParsedData } from \"./ParsedData\";\nimport { Line } from \"es-data-parser/dist/structures\";\n\nexport class WormholeDetails {\n    isMappable = false;\n    links: [string, string][] = [];\n    color: Color | string = \"\";\n\n    constructor(private esData: ParsedData, public name: string) {}\n\n    static fromLine(data: ParsedData, dataLine: Line) {\n        if (dataLine.tokens[0] != 'wormhole') {\n            throw new Error(\"Not a wormhole\");\n        }\n\n        const name = dataLine.tokens[1];\n\n        let mappable = false;\n        let color: Color | string = \"\";\n        let links: [string, string][] = [];\n\n        for (let child of dataLine.children) {\n            switch (child.tokens[0]) {\n                case 'color':\n                    if (child.tokens.length == 2) {\n                        color = child.tokens[1];\n                    }\n                    else {\n                        let r = parseFloat(dataLine.tokens[1]);\n                        let g = parseFloat(dataLine.tokens[2]);\n                        let b = parseFloat(dataLine.tokens[3]);\n                        let a = 255\n                        if (dataLine.tokens.length == 5) {\n                            a = parseFloat(dataLine.tokens[4]);\n                        }\n                        color = Color.fromPercentages('', r, g, b, a);\n                    }\n                    break;\n\n                case 'link':\n                    links.push(\n                        [ child.tokens[1], child.tokens[2] ]\n                    );\n                    break;\n                case 'mappable':\n                    mappable = true;\n                    break;\n            }\n        }\n\n        const wormhole = new WormholeDetails(data, name);\n        wormhole.isMappable = mappable;\n        wormhole.color = color;\n        wormhole.links = links;\n\n        return wormhole;\n    }\n}\n","import { ParsedData } from \"../es-data/ParsedData\";\nimport { StarSystem } from \"../es-data/StarSystem\";\nimport { Galaxy } from \"../es-data/Galaxies\";\nimport { FileRoot } from \"es-data-parser/dist/structures\";\nimport { parseFile } from \"es-data-parser\";\nimport { Color } from \"../es-data/Color\";\nimport { Government } from \"../es-data/Government\";\nimport { PlanetDetails } from \"../es-data/Planet\";\nimport { WormholeDetails } from \"../es-data/Wormhole\";\n\n\nexport async function parse(files: File[]) {\n    const parsedData = new ParsedData();\n    const roots: FileRoot[] = [];\n\n    for (let file of files) {\n        if (\n            file.webkitRelativePath.match(/^([^\\/]+\\/)?data\\//) !== null) {\n            let fileroot = await parseFile(file, file.webkitRelativePath);\n\n            roots.push(fileroot);\n\n            for (let child of fileroot.children) {\n                if (child.tokens[0] == 'system') {\n                    parsedData.addStarSystem(StarSystem.fromLine(parsedData, child));\n                }\n                else if (child.tokens[0] == 'galaxy') {\n                    const galaxy = Galaxy.fromLine(parsedData, child)\n                    await galaxy.loadImage();\n                    parsedData.addGalaxy(galaxy);\n                }\n                else if (child.tokens[0] == 'color') {\n                    parsedData.addColor(Color.fromLine(child));\n                }\n                else if (child.tokens[0] == 'government') {\n                    parsedData.addGovernment(Government.fromLine(parsedData, child));\n                }\n                else if (child.tokens[0] == 'planet') {\n                    parsedData.addPlanet(PlanetDetails.fromLine(parsedData, child));\n                }\n                else if (child.tokens[0] == 'wormhole') {\n                    parsedData.addWormhole(WormholeDetails.fromLine(parsedData, child));\n                }\n            }\n        }\n        else if (file.webkitRelativePath.includes('/images/')) {\n            let relativePath = file.webkitRelativePath.split('/images/')[1];\n\n            // remove extension (i.e. .png) from relative path\n            relativePath = relativePath.split('.')[0];\n\n            if (\n                relativePath.at(-1) == '+' ||\n                relativePath.at(-1) == '~' ||\n                relativePath.at(-1) == '-'\n            ) {\n                relativePath = relativePath.slice(0, -1);\n            }\n\n            if (!relativePath) continue;\n\n            parsedData.addSprite(relativePath, file);\n        }\n    }\n\n    console.log(parsedData);\n    return parsedData;\n}\n","export class CanvasLib extends EventTarget {\n    constructor(canvas) {\n        super();\n        this.canvas = canvas;\n        this.plugins = new Map();\n        const ctx = this.canvas.getContext(\"2d\");\n        if (ctx == null) {\n            throw ('Could not get the context for the canvas');\n        }\n        this.context = ctx;\n    }\n    renderCycle() {\n        this.paint();\n        window.requestAnimationFrame(() => this.renderCycle());\n    }\n    use(PluginClass, settings) {\n        const plugin = new PluginClass(this, settings);\n        this.plugins.set(plugin.name, plugin);\n    }\n    getPlugin(PluginClass) {\n        for (let plugin of this.plugins.values()) {\n            if (plugin instanceof PluginClass) {\n                return plugin;\n            }\n        }\n        return undefined;\n    }\n    /**\n     * Main paint function for the canvas\n     *\n     * @param shouldClear If true, clear the canvas before painting\n     */\n    paint(shouldClear = true) {\n        this.prepareContext(shouldClear);\n        const prop = { context: this.context };\n        this.preRender(prop);\n        this.render(prop);\n        this.postRender(prop);\n    }\n    prepareContext(shouldClear = true) {\n        this.context.resetTransform();\n        if (shouldClear) {\n            this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        }\n        this.context.translate(Math.floor(this.canvas.width / 2), Math.floor(this.canvas.height / 2));\n    }\n    /**\n     * Just a utility function to make the user code less heavy\n     */\n    on(event, callback) {\n        this.addEventListener(event, callback);\n    }\n    startRendering() {\n        window.requestAnimationFrame(() => this.renderCycle());\n    }\n    preRender(eventProp) {\n        const e = new CustomEvent('prerender', { detail: eventProp });\n        this.dispatchEvent(e);\n    }\n    render(eventProp) {\n        const e = new CustomEvent('render', { detail: eventProp });\n        this.dispatchEvent(e);\n    }\n    postRender(eventProp) {\n        const e = new CustomEvent('postrender', { detail: eventProp });\n        this.dispatchEvent(e);\n    }\n}\n","import { ParsedData } from \"../../es-data/ParsedData\";\nimport { PanZoomPlugin } from \"@andreadev/canvas-lib/dist/modules/pan-zoom-plugin\";\nimport { View } from \"./abstract\";\nimport { CanvasLib } from \"@andreadev/canvas-lib\";\n\n\nexport class GalaxyView extends EventTarget implements View {\n\n    shouldRenderNames = true;\n    shouldRenderLinks = true;\n    shouldRenderDots  = true;\n    shouldRenderGalaxies = true;\n    shouldRenderWormholeLinks = true;\n    shouldRenderHiddenWormholes = true;\n\n    constructor(private esData: ParsedData, private canvasLib: CanvasLib) { super(); }\n\n    activate() {\n        document.getElementById('toggle-galaxies')?.addEventListener('change', this.toggleGalaxies.bind(this))\n        document.getElementById('toggle-pins')?.addEventListener('change', this.toggleDots.bind(this))\n        document.getElementById('toggle-names')?.addEventListener('change', this.toggleNames.bind(this))\n        document.getElementById('toggle-links')?.addEventListener('change', this.toggleLinks.bind(this))\n        document.getElementById('toggle-wormholes')?.addEventListener('change', this.toggleWormholes.bind(this))\n        document.getElementById('toggle-hidden-wormholes')?.addEventListener('change', this.toggleHiddenWormholes.bind(this))\n    }\n\n    deactivate() {\n        // Removing event listeners will not work because of \"bind\"\n        // document.getElementById('toggle-galaxies')?.removeEventListener('change', this.toggleGalaxies)\n        // document.getElementById('toggle-pins')?.addEventListener('change', this.toggleDots)\n        // document.getElementById('toggle-names')?.addEventListener('change', this.toggleNames)\n        // document.getElementById('toggle-links')?.addEventListener('change', this.toggleLinks)\n    }\n\n    toggleNames(e: Event) {\n        this.shouldRenderNames = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n    toggleLinks(e: Event) {\n        this.shouldRenderLinks = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n    toggleDots(e: Event) {\n        this.shouldRenderDots = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n    toggleGalaxies(e: Event) {\n        this.shouldRenderGalaxies = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n    toggleWormholes(e: Event) {\n        this.shouldRenderWormholeLinks = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n    toggleHiddenWormholes(e: Event) {\n        this.shouldRenderHiddenWormholes = (<HTMLInputElement>e.target).checked; \n        this.canvasLib.paint();\n    }\n\n    preRender(ctx: CanvasRenderingContext2D) {\n        if (!this.esData) return;\n\n        // Draw all galaxies\n        if (this.shouldRenderGalaxies) {\n            for (let galaxy of this.esData.galaxies.values()) {\n                galaxy.render(ctx);\n            }\n        }\n\n        if (this.shouldRenderLinks) {\n            // Draw all links\n            ctx.lineWidth = PanZoomPlugin.fixedNumber(1, ctx);\n            ctx.strokeStyle = 'rgba(255,255,255,0.2)';\n            for (let link of this.esData.starSystemsLinks.values()) {\n                let [originName, targetName] = link.split('___');\n\n                let origin = this.esData.starSystems.get(originName);\n                let target = this.esData.starSystems.get(targetName);\n\n                if (!target || !origin)\n                    continue;\n\n                ctx.beginPath();\n                ctx.moveTo(origin.position.x, origin.position.y);\n\n                ctx.lineTo(target.position.x, target.position.y);\n                ctx.stroke();\n            }\n        }\n\n        if (this.shouldRenderWormholeLinks) {\n            // Draw all links\n            ctx.lineWidth = PanZoomPlugin.fixedNumber(1, ctx);\n            ctx.strokeStyle = 'rgba(100,100,255,0.5)';\n            for (let wormhole of this.esData.wormholes.values()) {\n                if (!wormhole.isMappable && !this.shouldRenderHiddenWormholes) continue;\n\n                for (let link of wormhole.links) {\n                    let [originName, targetName] = link;\n\n                    let origin = this.esData.starSystems.get(originName);\n                    let target = this.esData.starSystems.get(targetName);\n\n                    if (!target || !origin)\n                        continue;\n\n                    ctx.beginPath();\n                    ctx.moveTo(origin.position.x, origin.position.y);\n\n                    ctx.lineTo(target.position.x, target.position.y);\n                    ctx.stroke();\n                }\n            }\n        }\n    }\n\n    render(ctx: CanvasRenderingContext2D) {\n        if (!this.esData) return;\n\n        // Draw all systems\n        for (let system of this.esData.starSystems.values()) {\n            if (this.shouldRenderDots) {\n                system.renderDot(ctx);\n            }\n            if (this.shouldRenderNames) {\n                system.renderName(ctx);\n            }\n        }\n    }\n\n    postRender(ctx: CanvasRenderingContext2D) {\n\n    }\n}\n","import { CanvasLib } from \"@andreadev/canvas-lib\";\nimport { PanZoomPlugin } from \"@andreadev/canvas-lib/dist/modules/pan-zoom-plugin\";\nimport { ParsedData } from \"../es-data/ParsedData\";\nimport { View } from \"./views/abstract\";\nimport { GalaxyView } from \"./views/galaxy\";\nimport { RenderingEvent } from \"@andreadev/canvas-lib/dist/main\";\n\nconst views: Record<string, View | null>= {\n    galaxy: null\n};\nlet currentView: View | null = null;\n\nexport function initCanvasLib(canvas: HTMLCanvasElement) {\n    // Fix canvas dimensions\n    let canvasBCR = canvas.getBoundingClientRect();\n    canvas.width = canvasBCR.width;\n    canvas.height = canvasBCR.height;\n\n    const canvasLib = new CanvasLib(canvas);\n    canvasLib.use(PanZoomPlugin, {});\n\n    // Setup rendering functions for the view\n    const preRender = (event: RenderingEvent) => {\n        currentView?.preRender(event.detail.context);\n    }\n    const render = async (event: RenderingEvent) => {\n        currentView?.render(event.detail.context);\n    }\n    const postRender = async (event: RenderingEvent) => {\n        currentView?.render(event.detail.context);\n    }\n    canvasLib.on('prerender', preRender);\n    canvasLib.on('render', render);\n    canvasLib.on('postrender', postRender);\n\n    return canvasLib;\n}\n\nexport function setCurrentView(view: View) {\n    currentView?.deactivate();\n    currentView = view;\n    currentView.activate();\n}\n\nexport function filesLoaded(lib: CanvasLib, data: ParsedData) {\n    views.galaxy = new GalaxyView(data, lib);\n    setCurrentView(views.galaxy);\n\n    lib.paint();\n}\n","export const openDirectory = async (): Promise<File[]> => {\n    // Use older apis because File System Access API seems to be working unnaturally\n    return new Promise((resolve) => {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.webkitdirectory = true;\n        \n        input.addEventListener('change', () => {\n            let files = Array.from(input.files as FileList);\n            resolve(files);\n        });\n        if ('showPicker' in HTMLInputElement.prototype) {\n            input.showPicker();\n        } else {\n            input.click();\n        }\n    });\n};\n\n// Probabilmente è qualcosa che andrebbe piuttosto impostato nella libreria CanvasLib.\nexport const throttle = (fn: Function, wait: number = 300) => {\n    let inThrottle: boolean;\n    let lastFn: ReturnType<typeof setTimeout>;\n    let lastTime: number;\n\n    return function (this: any) {\n        const context = this,\n        args = arguments;\n        if (!inThrottle) {\n            fn.apply(context, args);\n            lastTime = Date.now();\n            inThrottle = true;\n        } else {\n            clearTimeout(lastFn);\n            lastFn = setTimeout(() => {\n                if (Date.now() - lastTime >= wait) {\n                    fn.apply(context, args);\n                    lastTime = Date.now();\n                }\n            }, Math.max(wait - (Date.now() - lastTime), 0));\n        }\n    };\n};\n\n","import { parse } from './src/parse';\nimport { filesLoaded, initCanvasLib } from './src/setupCanvasLib';\nimport { openDirectory } from './utils';\nimport { CanvasLib } from '@andreadev/canvas-lib';\nimport { bindUI } from './src/ui';\n\nlet lib: CanvasLib | null = null;\n\nasync function initApp() {\n    const filesInfo = await openDirectory();\n\n    const data = await parse(filesInfo);\n\n    let canvas = document.getElementById('viewer') as HTMLCanvasElement;\n\n    lib = initCanvasLib(canvas);\n    \n    filesLoaded(lib, data);\n\n    bindUI(lib);\n};\n\n// Bind open project button\ndocument.getElementById('select-file')?.addEventListener('click', () => {\n    initApp();\n});\n","import { CanvasLib } from \"@andreadev/canvas-lib\";\nimport { PanZoomPlugin } from \"@andreadev/canvas-lib/dist/modules/pan-zoom-plugin\";\n\n\nexport function bindUI(lib: CanvasLib) {\n    // Setup event listeners for the UI\n    document.getElementById('zoom-in')?.addEventListener('click', () => {\n        const panZoomPlugin = lib.getPlugin(PanZoomPlugin);\n\n        if (!panZoomPlugin) return;\n\n        panZoomPlugin.zoom(0.2);\n    });\n\n    document.getElementById('zoom-out')?.addEventListener('click', () => {\n        const panZoomPlugin = lib.getPlugin(PanZoomPlugin);\n\n        if (!panZoomPlugin) return;\n\n        panZoomPlugin.zoom(-0.2);\n    });\n\n    document.getElementById('viewer')?.addEventListener('pointerdown', (e) => {\n        const panZoomPlugin = lib.getPlugin(PanZoomPlugin);\n\n        if (!panZoomPlugin) return;\n\n        console.log(panZoomPlugin.screenToLocalPoint(e.clientX, e.clientY));\n    })\n}\n"],"names":["$f1123154cef67b66$export$aa361464e3df6895","galaxies","Map","starSystems","colors","sprites","governments","planets","wormholes","starSystemsLinks","Set","constructor","addGalaxy","galaxy","this","set","name","addStarSystem","starSystem","link","links","linkedSystem","get","linkString","reverseLinkString","has","add","addSprite","path","sprite","addColor","color","addGovernment","gov","addPlanet","planet","addWormhole","wormhole","$ac7a4858d2a8992b$export$de363e709c412c8a","func","wait","timeout","isThrottled","args","arguments","apply","clearTimeout","setTimeout","$994b89504fcb0ca2$export$4d5de249200f86f7","app","settings","_a","_b","_c","currentZoom","minZoom","maxZoom","cameraOffset","x","y","isPanning","startedPanningOffset","startedPanningPosition","throttle","bindEvents","throttledPaint","paint","bind","on","transformCanvas","canvas","addEventListener","onPointerDown","onPointerUp","onPointerMove","onScroll","screenToLocalPoint","hw","width","hh","height","tx","ty","z","zoom","amount","Math","min","max","floor","updateRender","e","detail","context","scale","translate","clientX","clientY","_","deltaY","static","matrix","scaleX","a","scaleY","d","translateX","translateY","f","skewX","b","skewY","c","number","direction","getDataFromMatrix","getTransform","$f1f0f5c6d9eed29b$export$892596cec99bc70e","r","g","toString","dataLine","label","tokens","parseFloat","length","fromPercentages","data","govName","government","$4f8e289126f413e4$export$60567d376fdb67d","esData","distance","period","offset","spriteImage","objects","Error","child","children","push","fromLine","systemObject","loadImage","Promise","resolve","reject","url","URL","createObjectURL","img","Image","onload","onerror","src","$c5ca37d8b9da03d5$export$ea149fec8837f72b","$c5ca37d8b9da03d5$export$804913e4ec6e385f","attributes","pos","foundPos","parseInt","slice","system","position","getBCR","top","bottom","left","right","render","ctx","renderLinks","renderDot","renderName","lineWidth","fixedNumber","strokeStyle","beginPath","moveTo","targetSystem","lineTo","stroke","fromGovernment","fillStyle","fixedSize","ellipse","PI","fill","fontSize","font","fillText","$b494b04b16341b2a$export$6509ed3b9b17fe1b","console","error","drawImage","$97a2f824b02b75ca$export$17d680238e50603e","indentation","tokensText","text","token","includes","$97a2f824b02b75ca$export$bd97b5a17cbaafd5","filename","super","isRoot","$acc3472be033e1d0$export$98e6a39c04603d36","root","isQuoteOpen","isComment","currentQuote","currentLine","currentToken","parentLevels","i","nextLine","join","$ea7d98d7be25fca1$export$f1c553d4f1a2351","file","reader","FileReader","result","readAsText","$ab59d5a7cd9e0c18$export$fb8111228a5af09a","$e3285f5c456ba44e$export$fc59f9442c61c779","$ff614e6edfa5dcd3$export$124803d07e39421a","isMappable","mappable","async","$59e043c0f225063d$export$98e6a39c04603d36","files","parsedData","roots","webkitRelativePath","match","fileroot","relativePath","split","at","log","$b5a9132486fa5f88$export$17e8e0f5ce5db525","EventTarget","plugins","getContext","renderCycle","window","requestAnimationFrame","use","PluginClass","plugin","getPlugin","values","shouldClear","prepareContext","prop","preRender","postRender","resetTransform","clearRect","event","callback","startRendering","eventProp","CustomEvent","dispatchEvent","$7a23650d329d929d$export$bbb64adae9205aa7","canvasLib","shouldRenderNames","shouldRenderLinks","shouldRenderDots","shouldRenderGalaxies","shouldRenderWormholeLinks","shouldRenderHiddenWormholes","activate","document","getElementById","toggleGalaxies","toggleDots","toggleNames","toggleLinks","toggleWormholes","toggleHiddenWormholes","deactivate","target","checked","originName","targetName","origin","$b788cc96538733ff$var$views","$b788cc96538733ff$var$currentView","$b788cc96538733ff$export$78cda6c44323997e","canvasBCR","getBoundingClientRect","$b788cc96538733ff$export$c64188370d7959c6","lib","view","$df5bef30413a053b$export$942f0b26f9f32b84","input","createElement","type","webkitdirectory","Array","from","HTMLInputElement","prototype","showPicker","click","$ad2bcec7a0192558$var$lib","$ad2bcec7a0192558$var$initApp","filesInfo","panZoomPlugin"],"version":3,"file":"index.233d4411.js.map"}